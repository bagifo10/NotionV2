async function g(n,l){if(!l)return"âš ï¸ Por favor ingresa tu API Key en la configuraciÃ³n.";try{const r=await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:n}]})})).json();return r.error?`Error: ${r.error.message}`:r.choices[0].message.content}catch{return"Error de conexiÃ³n con la IA."}}function h(){const n=document.createElement("div");n.className="w-full h-full flex-col",n.style.maxWidth="900px",n.style.margin="0 auto",n.style.height="calc(100vh - 140px)";const l=document.createElement("div");l.className="flex justify-between items-center mb-4";const m=document.createElement("div"),r=document.createElement("button");r.innerText="âš™ï¸ Configurar Key",r.className="text-xs hover-bg",r.style.color="var(--text-muted)",r.style.padding="4px 8px",r.style.borderRadius="var(--radius-sm)",r.onclick=()=>{confirm("Â¿Quieres cambiar/borrar tu API Key guardada?")&&(localStorage.removeItem("openai_api_key"),location.reload())},l.appendChild(m),l.appendChild(r);const a=document.createElement("div");a.className="flex-col gap-md",a.style.flex="1",a.style.overflowY="auto",a.style.padding="var(--spacing-md) 0";const p=(i,d)=>{const c=document.createElement("div");c.className=`flex w-full ${d==="user"?"justify-between":""}`,c.style.justifyContent=d==="user"?"flex-end":"flex-start";const e=document.createElement("div");e.style.padding="var(--spacing-md)",e.style.borderRadius="var(--radius-lg)",e.style.maxWidth="70%",e.style.lineHeight="1.6",e.style.fontSize="0.95rem",d==="user"?(e.style.backgroundColor="var(--accent-primary)",e.style.color="var(--bg-app)",e.style.borderBottomRightRadius="2px",e.style.fontWeight="500"):(e.style.backgroundColor="var(--bg-card)",e.style.color="var(--text-main)",e.style.border="1px solid var(--border-light)",e.style.borderBottomLeftRadius="2px"),e.innerText=i,c.appendChild(e),a.appendChild(c),a.scrollTop=a.scrollHeight};p("Â¡Hola! Soy NotionIA. Â¿CÃ³mo puedo ayudarte hoy?","ai");const o=document.createElement("div");o.className="flex items-center gap-sm",o.style.backgroundColor="var(--bg-card)",o.style.padding="var(--spacing-sm)",o.style.borderRadius="var(--radius-lg)",o.style.border="1px solid var(--border-light)",o.style.marginTop="var(--spacing-md)";const u=document.createElement("button");u.innerText="ðŸ“Ž",u.className="hover-bg",u.style.padding="8px",u.style.borderRadius="var(--radius-sm)";const t=document.createElement("input");t.type="text",t.id="chat-input",t.placeholder="Pregunta a NotionIA...",t.className="w-full",t.style.background="transparent",t.style.border="none",t.style.outline="none",t.style.color="var(--text-main)",t.style.padding="8px",t.style.fontSize="1rem";const s=document.createElement("button");s.innerText="âž¤",s.className="flex items-center justify-center",s.style.width="36px",s.style.height="36px",s.style.backgroundColor="var(--accent-primary)",s.style.borderRadius="50%",s.style.color="var(--bg-app)";const y=async()=>{const i=t.value.trim();if(!i)return;p(i,"user"),t.value="",p("Pensando...","ai");const d=localStorage.getItem("openai_api_key");if(!d){p("âš ï¸ Falta la API Key. Recarga la pÃ¡gina para configurarla.","ai"),a.removeChild(a.lastChild);return}const c=await g(i,d);a.removeChild(a.lastChild),p(c,"ai")};return s.onclick=y,t.onkeypress=i=>{i.key==="Enter"&&y()},o.appendChild(u),o.appendChild(t),o.appendChild(s),n.appendChild(l),n.appendChild(a),n.appendChild(o),n}export{h as Chatbot};
